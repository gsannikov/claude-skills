# Dependency Graph for Claude Skills Monorepo
# This file defines relationships between files for cascading updates
#
# Usage: When you modify a source file, all dependents need review/rebuild
# Run: python shared/scripts/dependency_tracker.py status
# Or ask Claude: "refactor" or "check dependencies"

version: "1.1.0"
updated: "2025-12-10"

# Global settings
settings:
  # How to detect changes: "git" (commits), "hash" (content hash), or "mtime" (modification time)
  change_detection: git
  # Auto-rebuild strategy: "prompt" (ask user), "auto" (rebuild all), "manual" (just report)
  rebuild_strategy: prompt

# File nodes with their metadata and dependencies
# Format:
#   path: relative path from repo root
#   type: source | derived | documentation | marketing
#   description: what this file is for
#   depends_on: list of files this depends on (upstream)
#   rebuild_instructions: how Claude should update this file when dependencies change

nodes:
  # ============================================
  # VOICE MEMOS SKILL
  # ============================================
  - path: packages/voice-memos/SKILL.md
    type: source
    description: Core voice memos skill logic and commands
    depends_on: []
    rebuild_instructions: |
      This is a source file. Changes here trigger updates to dependents.
      When modifying: Update version.yaml and CHANGELOG.md

  - path: packages/voice-memos/_dev/README.md
    type: derived
    description: User-facing documentation for voice memos skill
    depends_on:
      - packages/voice-memos/SKILL.md
    rebuild_instructions: |
      Regenerate from SKILL.md:
      1. Extract command examples
      2. Update feature list
      3. Sync supported formats
      4. Update usage examples

  - path: packages/voice-memos/meeting-recorder/README.md
    type: derived
    description: Meeting recorder submodule documentation
    depends_on:
      - packages/voice-memos/meeting-recorder/MeetingRecorder/Sources/
    rebuild_instructions: |
      Update based on Swift source changes:
      1. Sync API documentation
      2. Update build instructions
      3. Reflect new features/fixes

  # ============================================
  # JOB ANALYZER SKILL
  # ============================================
  - path: packages/job-analyzer/SKILL.md
    type: source
    description: Core job analyzer skill logic
    depends_on: []
    rebuild_instructions: |
      This is a source file. When modifying:
      1. Update version.yaml
      2. Update CHANGELOG.md
      3. Ensure modules/ are in sync

  - path: packages/job-analyzer/_dev/README.md
    type: derived
    description: User documentation for job analyzer
    depends_on:
      - packages/job-analyzer/SKILL.md
      - packages/job-analyzer/modules/
    rebuild_instructions: |
      Sync with SKILL.md and modules:
      1. Update command reference
      2. Sync scoring system description
      3. Update workflow examples

  - path: packages/job-analyzer/modules/database-operations-hybrid.md
    type: source
    description: Database operations module
    depends_on: []
    rebuild_instructions: |
      Source module. Changes affect SKILL.md integration.

  # ============================================
  # INTERVIEW PREP SKILL
  # ============================================
  - path: packages/interview-prep/SKILL.md
    type: source
    description: Core interview prep skill logic
    depends_on: []
    rebuild_instructions: |
      Source file. Update version.yaml and CHANGELOG.md on changes.

  - path: packages/interview-prep/_dev/README.md
    type: derived
    description: User documentation for interview prep
    depends_on:
      - packages/interview-prep/SKILL.md
    rebuild_instructions: |
      Sync with SKILL.md:
      1. Update command reference
      2. Sync STAR framework info

  # ============================================
  # READING LIST SKILL
  # ============================================
  - path: packages/reading-list/SKILL.md
    type: source
    description: Core reading list skill logic
    depends_on: []
    rebuild_instructions: |
      Source file. Update version.yaml and CHANGELOG.md on changes.

  - path: packages/reading-list/_dev/README.md
    type: derived
    description: User documentation for reading list
    depends_on:
      - packages/reading-list/SKILL.md
    rebuild_instructions: |
      Sync commands and features from SKILL.md

  # ============================================
  # IDEAS CAPTURE SKILL
  # ============================================
  - path: packages/ideas-capture/SKILL.md
    type: source
    description: Core ideas capture skill logic
    depends_on: []
    rebuild_instructions: |
      Source file. Update version.yaml and CHANGELOG.md on changes.

  - path: packages/ideas-capture/_dev/README.md
    type: derived
    description: User documentation for ideas capture
    depends_on:
      - packages/ideas-capture/SKILL.md
    rebuild_instructions: |
      Sync scoring dimensions and commands from SKILL.md

  # ============================================
  # SOCIAL MEDIA POST SKILL
  # ============================================
  - path: packages/social-media-post/SKILL.md
    type: source
    description: Core social media post generator skill logic
    depends_on: []
    rebuild_instructions: |
      Source file. Update version.yaml and CHANGELOG.md on changes.

  - path: packages/social-media-post/_dev/README.md
    type: derived
    description: User documentation for social media post skill
    depends_on:
      - packages/social-media-post/SKILL.md
    rebuild_instructions: |
      Sync commands, platforms, and features from SKILL.md

  # ============================================
  # LOCAL RAG SKILL
  # ============================================
  - path: packages/local-rag/SKILL.md
    type: source
    description: Core local RAG skill logic
    depends_on: []
    rebuild_instructions: |
      Source file. Update version.yaml and CHANGELOG.md on changes.

  - path: packages/local-rag/_dev/README.md
    type: derived
    description: User documentation for local RAG
    depends_on:
      - packages/local-rag/SKILL.md
      - packages/local-rag/_dev/docs/architecture.md
    rebuild_instructions: |
      Sync from SKILL.md and architecture docs:
      1. Update supported file types
      2. Sync MCP configuration
      3. Update query examples

  # ============================================
  # RECIPE MANAGER SKILL
  # ============================================
  - path: packages/recipe-manager/SKILL.md
    type: source
    description: Core recipe manager skill logic
    depends_on: []
    rebuild_instructions: |
      Source file. Update version.yaml and CHANGELOG.md on changes.

  - path: packages/recipe-manager/_dev/README.md
    type: derived
    description: User documentation for recipe manager
    depends_on:
      - packages/recipe-manager/SKILL.md
    rebuild_instructions: |
      Sync commands and features from SKILL.md

  - path: packages/local-rag/_dev/docs/architecture.md
    type: source
    description: Local RAG architecture documentation
    depends_on:
      - packages/local-rag/scripts/
    rebuild_instructions: |
      Update when scripts change significantly

  # ============================================
  # ROOT DOCUMENTATION (aggregates skills)
  # ============================================
  - path: docs/user-guide.md
    type: derived
    description: Comprehensive user guide for all skills
    depends_on:
      - packages/voice-memos/SKILL.md
      - packages/job-analyzer/SKILL.md
      - packages/interview-prep/SKILL.md
      - packages/reading-list/SKILL.md
      - packages/ideas-capture/SKILL.md
      - packages/local-rag/SKILL.md
      - packages/social-media-post/SKILL.md
      - packages/setup-manager/SKILL.md
      - packages/next-skill/SKILL.md
    rebuild_instructions: |
      This is the main user-facing documentation. When any skill changes:
      1. Update the corresponding skill section
      2. Sync command examples
      3. Update supported formats/features
      4. Ensure Quick Start table is accurate
      5. Update version number at bottom

  - path: README.md
    type: derived
    description: Repository overview and quick start
    depends_on:
      - docs/user-guide.md
      - docs/project-status.md
    rebuild_instructions: |
      Sync overview from docs/user-guide.md and docs/project-status.md:
      1. Update skill count and list
      2. Sync quick start commands
      3. Update installation steps if changed

  - path: docs/developer-guide.md
    type: derived
    description: Developer documentation
    depends_on:
      - docs/project-status.md
      - shared/scripts/
    rebuild_instructions: |
      Update when shared scripts or architecture changes:
      1. Sync script documentation
      2. Update contribution workflow
      3. Reflect new patterns

  - path: docs/project-status.md
    type: source
    description: Architecture decisions and roadmap
    depends_on: []
    rebuild_instructions: |
      Source file for project-level decisions. Update manually.

  - path: CLAUDE.md
    type: derived
    description: Global Claude instructions
    depends_on:
      - docs/project-status.md
      - packages/*/SKILL.md
    rebuild_instructions: |
      Update quick reference table when skills change:
      1. Sync skill commands
      2. Update Apple Note names
      3. Reflect new patterns

  # ============================================
  # MARKETING / BLOG CONTENT
  # ============================================
  - path: shared/marketing/posts/article-1-building-production-grade-skills.md
    type: marketing
    description: Blog post about skill architecture
    depends_on:
      - packages/job-analyzer/SKILL.md
      - docs/project-status.md
    rebuild_instructions: |
      Review for accuracy when architecture changes:
      1. Update code examples if APIs changed
      2. Verify diagrams match current architecture
      3. Update version references

  - path: shared/marketing/posts/article-2-skills-deep-dive.md
    type: marketing
    description: Deep dive into skill features
    depends_on:
      - docs/user-guide.md
    rebuild_instructions: |
      Sync feature descriptions with docs/user-guide.md

  - path: shared/marketing/posts/article-3-monorepo.md
    type: marketing
    description: Monorepo architecture article
    depends_on:
      - docs/project-status.md
    rebuild_instructions: |
      Update if monorepo structure changes

  - path: shared/marketing/posts/article-4-lessons-learned.md
    type: marketing
    description: Lessons learned article
    depends_on:
      - shared/templates/learned-patterns.yaml
    rebuild_instructions: |
      Sync with learned-patterns.yaml when new patterns added

  # ============================================
  # SHARED UTILITIES
  # ============================================
  - path: shared/templates/learned-patterns.yaml
    type: source
    description: Best practices and patterns
    depends_on: []
    rebuild_instructions: |
      Source file. Add new patterns as discovered.

  - path: shared/scripts/release.py
    type: source
    description: Release automation script
    depends_on: []
    rebuild_instructions: |
      Source file. Update for new release requirements.

  # ============================================
  # NEXT-SKILL (SKILL FACTORY)
  # ============================================
  - path: packages/next-skill/SKILL.md
    type: source
    description: Skill factory - AI-assisted skill creation with GitHub discovery, adaptation, or fresh scaffolding
    depends_on: []
    rebuild_instructions: |
      Source file. Update version.yaml and CHANGELOG.md on changes.

  - path: packages/next-skill/_dev/design.md
    type: source
    description: Design documentation for skill factory
    depends_on:
      - packages/next-skill/SKILL.md
    rebuild_instructions: |
      Update when SKILL.md architecture changes

  # ============================================
  # SETUP MANAGER SKILL
  # ============================================
  - path: packages/setup-manager/SKILL.md
    type: source
    description: Core setup and maintenance manager skill logic
    depends_on: []
    rebuild_instructions: |
      Source file. Update version.yaml and CHANGELOG.md on changes.

  - path: packages/setup-manager/_dev/README.md
    type: derived
    description: User documentation for setup manager
    depends_on:
      - packages/setup-manager/SKILL.md
    rebuild_instructions: |
      Sync commands and features from SKILL.md

  # ============================================
  # REPOSITORY DOCUMENTATION
  # ============================================
  - path: docs/vision.md
    type: source
    description: Vision, problem statement, user personas, and roadmap
    depends_on: []
    rebuild_instructions: |
      Source file for project vision and strategy. Update manually.

  - path: install.sh
    type: source
    description: Main installation script
    depends_on: []
    rebuild_instructions: |
      Update when:
      1. Project structure changes
      2. New dependencies are added
      3. Python version requirements change

  - path: docs/automation-guide.md
    type: documentation
    description: Guide for automated agents
    depends_on:
      - docs/project-status.md
    rebuild_instructions: |
      Update when automation patterns or tools change.

  - path: AGENTS.md
    type: documentation
    description: Agent persona definitions
    depends_on:
      - docs/project-status.md
    rebuild_instructions: |
      Update when new agent roles are defined.

  - path: SECURITY.md
    type: documentation
    description: Security policy
    depends_on: []
    rebuild_instructions: |
      Update manually for security policy changes.

  - path: CHANGELOG.md
    type: documentation
    description: Project history
    depends_on:
      - packages/*/SKILL.md
    rebuild_instructions: |
      Update after every release or significant change.

  - path: CONTRIBUTING.md
    type: documentation
    description: Contributor guidelines and coding conventions
    depends_on:
      - docs/project-status.md
      - shared/templates/learned-patterns.yaml
    rebuild_instructions: |
      Update when:
      1. Coding standards change
      2. New patterns added to learned-patterns.yaml
      3. Project architecture evolves

  - path: docs/faq.md
    type: documentation
    description: Frequently asked questions for users and developers
    depends_on:
      - docs/user-guide.md
      - docs/developer-guide.md
      - packages/*/_dev/README.md
    rebuild_instructions: |
      Update when:
      1. Common issues emerge
      2. Skills add new features
      3. Installation process changes
      4. Best practices evolve

  # ============================================
  # GITHUB ISSUE TEMPLATES
  # ============================================
  - path: .github/ISSUE_TEMPLATE/bug_report.md
    type: documentation
    description: Bug report issue template
    depends_on:
      - docs/project-status.md
    rebuild_instructions: |
      Update if project structure or debugging requirements change

  - path: .github/ISSUE_TEMPLATE/feature_request.md
    type: documentation
    description: Feature request issue template
    depends_on:
      - docs/project-status.md
      - docs/vision.md
    rebuild_instructions: |
      Update if roadmap or feature priorities change

  - path: .github/ISSUE_TEMPLATE/documentation.md
    type: documentation
    description: Documentation improvement issue template
    depends_on: []
    rebuild_instructions: |
      Standalone template. Update as documentation needs evolve.

  - path: .github/ISSUE_TEMPLATE/performance_issue.md
    type: documentation
    description: Performance issue template
    depends_on:
      - docs/project-status.md
    rebuild_instructions: |
      Update if performance metrics or monitoring changes

  - path: .github/ISSUE_TEMPLATE/question.md
    type: documentation
    description: Question issue template
    depends_on:
      - docs/faq.md
    rebuild_instructions: |
      Update to point users to FAQ for common questions

  - path: .github/ISSUE_TEMPLATE/security_vulnerability.md
    type: documentation
    description: Security vulnerability report template
    depends_on: []
    rebuild_instructions: |
      Standalone security template. Update as security policies evolve.

# Dependency groups for batch operations
groups:
  voice-memos:
    description: All voice memos related files
    members:
      - packages/voice-memos/SKILL.md
      - packages/voice-memos/_dev/README.md
      - packages/voice-memos/meeting-recorder/README.md

  job-analyzer:
    description: All job analyzer related files
    members:
      - packages/job-analyzer/SKILL.md
      - packages/job-analyzer/_dev/README.md
      - packages/job-analyzer/modules/

  interview-prep:
    description: All interview prep related files
    members:
      - packages/interview-prep/SKILL.md
      - packages/interview-prep/_dev/README.md

  social-media-post:
    description: All social media post related files
    members:
      - packages/social-media-post/SKILL.md
      - packages/social-media-post/_dev/README.md
      - packages/social-media-post/config/

  setup-manager:
    description: All setup manager related files
    members:
      - packages/setup-manager/SKILL.md
      - packages/setup-manager/_dev/README.md

  recipe-manager:
    description: All recipe manager related files
    members:
      - packages/recipe-manager/SKILL.md
      - packages/recipe-manager/_dev/README.md

  next-skill:
    description: Skill factory for creating new skills
    members:
      - packages/next-skill/SKILL.md
      - packages/next-skill/_dev/design.md
      - packages/next-skill/modules/
      - packages/next-skill/templates/

  documentation:
    description: All user-facing documentation
    members:
      - docs/user-guide.md
      - README.md
      - docs/developer-guide.md
      - CLAUDE.md
      - docs/vision.md
      - CONTRIBUTING.md
      - docs/faq.md
      - CONTRIBUTING.md
      - docs/faq.md
      - .github/ISSUE_TEMPLATE/
      - install.sh
      - docs/automation-guide.md
      - AGENTS.md
      - SECURITY.md
      - CHANGELOG.md

  marketing:
    description: All marketing/blog content
    members:
      - shared/marketing/posts/article-1-building-production-grade-skills.md
      - shared/marketing/posts/article-2-skills-deep-dive.md
      - shared/marketing/posts/article-3-monorepo.md
      - shared/marketing/posts/article-4-lessons-learned.md
