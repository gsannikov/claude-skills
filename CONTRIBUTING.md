# Contributing to Claude Skills

Thank you for your interest in contributing to the Claude Skills Ecosystem! This document provides guidelines and instructions for contributing.

---

## Table of Contents

- [Code of Conduct](#code-of-conduct)
- [Getting Started](#getting-started)
- [Development Setup](#development-setup)
- [Project Structure](#project-structure)
- [Making Changes](#making-changes)
- [Creating a New Skill](#creating-a-new-skill)
- [Submitting Changes](#submitting-changes)
- [Style Guidelines](#style-guidelines)
- [Testing](#testing)
- [Release Process](#release-process)

---

## Code of Conduct

Please be respectful and constructive in all interactions. We're building tools to help people be more productive - let's embody that spirit in our collaboration.

---

## Getting Started

### Prerequisites

- **Git** for version control
- **Python 3.8+** for scripts and utilities
- **Claude.ai account** for testing skills
- **GitHub account** for contributions

### Fork & Clone

```bash
# Fork the repository on GitHub, then:
git clone https://github.com/YOUR_USERNAME/claude-skills.git
cd claude-skills
```

---

## Development Setup

### 1. Install Dependencies

```bash
# Core dependencies
pip install pyyaml

# For local-rag skill
pip install chromadb sentence-transformers

# For job-analyzer Excel features (tracking)
pip install pandas openpyxl
```

### 2. Verify Structure

```bash
# Run validation
python -c "
import yaml
import glob
for f in glob.glob('packages/**/version.yaml', recursive=True):
    with open(f) as file:
        data = yaml.safe_load(file.read())
        print(f'✅ {data[\"skill\"]} v{data[\"version\"]}')
"
```

### 3. Test a Skill

1. Upload a skill folder to Claude.ai
2. Run basic commands
3. Verify expected behavior

---

## Project Structure

```
claude-skills/
├── packages/                      # Individual skills (one folder each)
│   └── {skill-name}/
│       ├── SKILL.md               # Main skill specification (REQUIRED)
│       ├── README.md              # Human documentation (REQUIRED)
│       ├── AI_GUIDE.md            # AI assistant guide (recommended)
│       ├── CHANGELOG.md           # Version history (REQUIRED)
│       ├── version.yaml           # Version info (REQUIRED)
│       ├── modules/               # On-demand modules
│       ├── scripts/               # Helper scripts
│       ├── config/                # Configuration files
│       └── templates/             # User templates
├── shared/
│   ├── scripts/                   # Cross-skill utilities
│   ├── templates/                 # Shared patterns
│   └── workflows/                 # Troubleshooting guides
├── .github/workflows/             # CI/CD
└── docs/                          # Additional documentation
```

### Required Files for Each Skill

| File | Purpose |
|------|---------|
| `SKILL.md` | Main specification loaded by Claude |
| `README.md` | Human-readable documentation |
| `CHANGELOG.md` | Version history |
| `version.yaml` | Version metadata |

### version.yaml Format

```yaml
version: 1.0.0
updated: 2025-11-25
skill: skill-name
codename: Descriptive Name
status: stable  # or: beta, alpha, deprecated
```

---

## Making Changes

### Branch Naming

```
feature/{skill-name}-{description}
fix/{skill-name}-{description}
docs/{description}
```

Examples:
- `feature/job-analyzer-linkedin-parsing`
- `fix/reading-list-duplicate-detection`
- `docs/contributing-guide`

### Commit Messages

Follow conventional commits:

```
type(scope): description

[optional body]

[optional footer]
```

Types:
- `feat` - New feature
- `fix` - Bug fix
- `docs` - Documentation only
- `refactor` - Code restructuring
- `test` - Adding tests
- `chore` - Maintenance tasks

Examples:
```
feat(interview-prep): add STAR story builder module
fix(reading-list): handle URLs with special characters
docs: update contributing guidelines
```

---

### Editing AI Instructions (AlignTrue)

> [!WARNING]
> **DO NOT** edit `CLAUDE.md`, `AGENTS.md`, or `.cursorrules` directly!
>
> These files are auto-generated by AlignTrue and will be overwritten on next sync.

**Correct Workflow:**
```bash
# 1. Edit source rules (single source of truth)
vim .aligntrue/rules/CLAUDE.md

# 2. Sync changes to all platforms
aligntrue sync

# 3. Verify exports
git status  
# Should show changes to:
#   .aligntrue/rules/CLAUDE.md (source)
#   CLAUDE.md (Claude Desktop)
#   AGENTS.md (OpenAI Codex, if enabled)
#   .cursorrules (Cursor IDE, if enabled)

# 4. Commit all changed files
git add .aligntrue/rules/CLAUDE.md CLAUDE.md AGENTS.md .cursorrules
git commit -m "docs: update AI instructions"
```

**Why AlignTrue?**
- Maintains consistency across Claude, OpenAI Codex, Cursor, and Google Antigravity
- Contributors can use their preferred AI assistant
- Single source of truth in `.aligntrue/rules/`
- Automatic export to platform-specific formats

**For More Details:** See [AlignTrue Workflow](docs/developer-guide.md#aligntrue-workflow)

---

## Creating a New Skill

### 1. Use the Generator (Recommended)

```bash
python shared/scripts/skill_generator.py --name "expense-tracker" --patterns inbox,database
```

### 2. Manual Creation

Create the minimum required structure:

```
packages/expense-tracker/
├── SKILL.md           # Main specification
├── README.md          # Documentation
├── AI_GUIDE.md        # AI assistant guide
├── CHANGELOG.md       # Version history
└── version.yaml       # Version info
```

### 3. SKILL.md Template

```markdown
---
name: expense-tracker
description: Brief description of what the skill does
---

# Expense Tracker

[Full skill specification following existing patterns]

## Key Capabilities
1. Feature 1
2. Feature 2

## Commands
- `process expenses` - Main command

## Workflow
[Detailed workflow steps]

---

**Version**: 1.0.0
**Status**: Stable
```

### 4. Add to Validation

Update `.github/workflows/validate.yml`:

```yaml
strategy:
  matrix:
    skill: [job-analyzer, reading-list, ..., expense-tracker]
```

---

## Submitting Changes

### Pull Request Process

1. **Create a branch** from `main`
2. **Make changes** following style guidelines
3. **Test locally** with Claude
4. **Update documentation** if needed
5. **Submit PR** with clear description

### PR Description Template

```markdown
## Summary
Brief description of changes

## Type of Change
- [ ] Bug fix
- [ ] New feature
- [ ] Documentation
- [ ] Refactoring

## Testing Done
- [ ] Tested with Claude.ai
- [ ] Ran validation scripts
- [ ] Updated relevant docs

## Related Issues
Fixes #123
```

### Review Process

1. Automated checks run (YAML validation, Python syntax)
2. Maintainer reviews code
3. Address feedback
4. Merge when approved

---

## Style Guidelines

### Markdown

- Use ATX headers (`#`, `##`, `###`)
- One sentence per line for easier diffs
- Use fenced code blocks with language hints
- Tables for structured data
- Links with descriptive text: `[job analyzer](packages/job-analyzer/)`

### YAML

- 2-space indentation
- Quote strings with special characters
- Use comments for complex configurations
- Maintain consistent field ordering
- Example:
  ```yaml
  version: 1.0.0
  updated: 2025-11-25
  skill: skill-name
  codename: Descriptive Name
  status: stable  # stable, beta, alpha, deprecated
  ```

### Python

**General**:
- Follow PEP 8
- Type hints encouraged for function signatures
- Docstrings for public functions (Google style)
- Keep scripts focused and simple (single responsibility)

**Naming**:
- `snake_case` for functions and variables
- `PascalCase` for classes
- `UPPER_CASE` for constants
- Descriptive names: `process_job_url()` not `proc()`

**Example**:
```python
def load_database(db_path: str) -> dict:
    """Load YAML database from filesystem.
    
    Args:
        db_path: Absolute path to YAML file
        
    Returns:
        Parsed database dictionary
        
    Raises:
        FileNotFoundError: If database doesn't exist
    """
    with open(db_path) as f:
        return yaml.safe_load(f)
```

### Skill Documentation

- Clear, actionable commands
- Real examples with expected output
- Token usage estimates for heavy operations
- Troubleshooting sections for common issues

---

## Comprehensive Coding Conventions

### SKILL.md Structure

**Required Sections** (in order):

1. **Frontmatter** (YAML):
   ```markdown
   ---
   name: skill-name
   description: One-line description
   version: 1.0.0
   ---
   ```

2. **Header**: `# Skill Name`

3. **Overview**: What the skill does, key capabilities

4. **Commands**: All user-facing commands with examples

5. **Workflows**: Step-by-step processes

6. **Configuration**: Any user configuration options

7. **Data Storage**: Where data is stored, format details

8. **Modules** (if applicable): On-demand modules available

9. **Token Budget**: Estimates for operations

10. **Version**: At bottom

**Best Practices**:
- Keep under 500 lines if possible (use modules for complexity)
- Include real examples with actual URLs/data
- Document all Apple Notes integration patterns
- Progressive disclosure: basics first, advanced later

### Module Architecture

**When to Use Modules**:
- Heavy processing (\u003e5,000 tokens)
- Specialized workflows (not used every time)
- Complex multi-step operations
- Expert-level features

**Module Structure**:
```markdown
# modules/advanced-search.md
---
name: advanced-search
type: on-demand
token_budget: 8000
---

[Full module specification]
```

**Loading Pattern**:
```markdown
To use advanced search:
1. Say "load advanced search module"
2. Claude will load and enable advanced features
3. Use command: "search with filters: ..."
```

### Security Guidelines

**Credential Management**:
- ❌ NEVER commit API keys, tokens, passwords
- ✅ Use environment variables or separate config files
- ✅ Add credential files to `.gitignore`
- ✅ Document credential setup in README

**User Data**:
- ❌ NEVER store user data in repo
- ✅ Always use centralized path config (`shared/config/paths.py`) - default: `~/Documents/claude-skills-data/`
- ✅ Sanitize scraped content before storage
- ✅ Respect user privacy (no logging of personal data)

**Input Validation**:
- Validate URLs before scraping
- Sanitize user input in commands
- Check file paths before writing
- Handle malformed YAML gracefully

**Example**:
```python
def validate_url(url: str) -> bool:
    """Validate URL is safe to scrape."""
    if not url.startswith(('http://', 'https://')):
        return False
    # Additional checks...
    return True
```

### Performance Best Practices

**Token Budget Management**:

1. **Progressive Loading**:
   ```markdown
   # Load summary first
   Database contains 500 jobs (Tier 1: 50, Tier 2: 200, Tier 3: 250)
   
   # Load details on demand
   "Show details for nvidia-tpm-20251120"
   ```

2. **On-Demand Modules**:
   - Don't load everything at start
   - Heavy modules loaded when requested
   - Clear modules after use if needed

3. **Chunking Large Operations**:
   ```markdown
   # Bad: Process 100 URLs at once
   # Good: Process 5 at a time, prompt to continue
   Processed 5 jobs. Continue with next 5? (95 remaining)
   ```

4. **Archiving Old Data**:
   - Move inactive items to `archive/` folder
   - Keep active database under 10,000 lines
   - Summarize old data in statistics

**File I/O**:
- Batch writes (don't write after every item)
- Use atomic writes (write to temp, then rename)
- Cache reads when possible
- Stream large files, don't load entirely

**Apple Notes**:
- Limit inbox to \u003c100 items
- Process in batches
- Clear processed items
- Handle timeouts gracefully

**Example**:
```python
# Batch processing pattern
BATCH_SIZE = 5

def process_inbox(items: list):
    """Process items in batches to avoid context overload."""
    for i in range(0, len(items), BATCH_SIZE):
        batch = items[i:i+BATCH_SIZE]
        process_batch(batch)
        
        if i + BATCH_SIZE < len(items):
            # Prompt to continue
            print(f"Processed {i+BATCH_SIZE}/{len(items)}. Continue?")
```

### Error Handling

**Be Graceful**:
- Always handle expected errors
- Provide actionable error messages
- Offer fallback options
- Don't crash the skill

**Example**:
```python
try:
    data = scrape_url(url)
except RequestTimeout:
    print("⚠️ Scrape timeout. Try using web_fetch or manual entry.")
    return None
except ValueError as e:
    print(f"❌ Invalid URL: {e}")
    return None
```

**Error Messages Should**:
- ✅ Explain what went wrong
- ✅ Suggest how to fix it
- ✅ Offer alternatives
- ❌ Don't just say "Error"

### Testing Checklist

Before submitting a skill:

- [ ] All documented commands work
- [ ] YAML files validate
- [ ] Python scripts run without errors
- [ ] Token budget estimates are accurate
- [ ] Error handling tested (bad URLs, missing files, etc.)
- [ ] README matches SKILL.md capabilities
- [ ] CHANGELOG.md updated
- [ ] version.yaml bumped appropriately

---

## Testing

### Manual Testing

1. Upload skill to Claude.ai
2. Test all documented commands
3. Verify file outputs
4. Check error handling

### Validation Scripts

```bash
# Validate all skills
python -c "
import yaml, glob, sys
errors = []
for f in glob.glob('packages/**/version.yaml', recursive=True):
    try:
        with open(f) as file:
            yaml.safe_load(file.read())
        print(f'✅ {f}')
    except Exception as e:
        errors.append(f'❌ {f}: {e}')
if errors:
    print('\\n'.join(errors))
    sys.exit(1)
"
```

### CI Checks

GitHub Actions automatically validates:
- Required files exist
- YAML syntax is valid
- Python scripts compile

---

## Release Process

### For Maintainers

1. **Update version.yaml**:
   ```yaml
   version: 1.1.0
   updated: 2025-11-25
   ```

2. **Update CHANGELOG.md**:
   ```markdown
   ## [1.1.0] - 2025-11-25
   ### Added
   - New feature X
   ### Fixed
   - Bug Y
   ```

3. **Create release**:
   ```bash
   python shared/scripts/release.py {skill-name} --minor
   ```

4. **Or use GitHub Actions**:
   - Go to Actions → Release Skill
   - Select skill and bump type
   - Run workflow

### Version Bumping

- **patch** (1.0.0 → 1.0.1): Bug fixes, minor docs
- **minor** (1.0.0 → 1.1.0): New features, non-breaking
- **major** (1.0.0 → 2.0.0): Breaking changes

---

## Questions?

- **Issues**: https://github.com/gsannikov/claude-skills/issues
- **Discussions**: https://github.com/gsannikov/claude-skills/discussions

---

Thank you for contributing!
